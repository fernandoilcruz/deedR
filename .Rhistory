credentials::set_github_pat()
#paste your PAT into pop-up that follows...
credentials::set_github_pat()
#paste your PAT (Personal Access Token) into pop-up that follows...
credentials::set_github_pat()
#now remotes::install_github() will work
remotes::install_github(repo = "fernandoilcruz/DEEDadosR",
auth_token = "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")
library(hexSticker)
library(geobr)
library(ggplot2)
library(tidyverse)
l
library(hexSticker)
library(geobr)
library(ggplot2)
library(tidyverse)
#Get Rio Grande do Sul shapefile
state <- geobr::read_municipality(
code_muni = 43,
year=2020,
showProgress = FALSE
)
#Get schools data:
schools <-
geobr::read_schools(year = 2020, showProgress = F) |>
filter(abbrev_state == "RS")
#Create plot
rs_plot2 <-
ggplot() +
geom_sf(data = state,
fill = NA,
color= NA,
# fill = "blue",
# color= "white"
#linewidth=0.1
) +
geom_sf(data = schools, colour = "white", size = 0.0001) +
theme_void() +
theme(axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
#Create sticker
#x<-
hexSticker::sticker(rs_plot2,
package="deedR",
p_family = "Aller_Rg",
p_fontface = "bold",
p_size=10,
p_x = 1,
p_y = 1.5,
s_x=0.95,
s_y=0.75,
s_width=2.2,
s_height=1.25,
#h_fill="darkgreen,
#h_color="white",
h_color = "#6897bb",
filename="logo/figures/logo_deedadosr.png")
library(devtools)
#now remotes::install_github() will work
library(devtools)
remotes::install_github(repo = "fernandoilcruz/DEEDadosR",
auth_token = "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")
#now remotes::install_github() will work
library(devtools)
remotes::install_github(repo = "fernandoilcruz/DEEDadosR",
auth_token = "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")
library(devtools)
load_all()
getwd()
library(devtools)
load_all()
library(devtools)
remotes::install_github(repo = "fernandoilcruz/DEEDadosR",
auth_token = "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")
getdata()
library(DEEDadosR)
?getdata
library(devtools)
?getdata
load_all()
?getdata
library(devtools)
load_all()
help(package = "DEEDadosR")
deetreeR
deetreeR()
deetree()
check()
getwd()
use_testthat()
use_testthat("getdata gest data with labels",{expect_equal(class(getdata),tibble})
use_testthat("getdata gest data with labels",{expect_equal(class(getdata),tibble}))
use_testthat("getdata gest data with labels",{expect_equal(class(getdata),tibble)})
use_testthat("getdata gest data with labels",{expect_equal(class(getdata),"tibble")})
use_testthat("getdata gest data with labels",{expect_equal(class(getdata()),"tibble")})
use_testthat("getdata gest data with labels",{expect_equal(class(getdata()),tibble)})
use_testthat("getdata gest data with labels",{expect_equal(is.tibble(getdata()),TRUE)})
use_testthat("getdata gest data with labels",{expect_error(getdata("a")})
use_testthat("getdata gest data with labels",{expect_error(getdata(add_labels = "a")})
use_testthat("getdata gest data with labels",{expect_error(getdata(add_labels = "a"))})
testthat("getdata gest data with labels",{expect_error(getdata(add_labels = "a"))})
testthat::testthat("getdata gest data with labels",{expect_error(getdata(add_labels = "a"))})
testthat::test_that("getdata gest data with labels",{expect_error(getdata(add_labels = "a"))})
check()
devtools::test()
usethis::use_testthat()
use_test()
check()
check()
library(devtools)
load_all()
document()
library(devtools)
load_all()
help(getdata[])
help(getdata)
my_data <- getdata(var_id = 1686,ag = "corede",period = c(2010:2015))
my_data
help(um)
um()
document()
my_data <- getdata(var_id = 1686,ag = "corede",period = c(2010:2015))
my_data
my_data <- getdata(var_id = 1686,ag = "corede",period = c(2010:2015), add_names = T)
my_data
document()
my_data <- getdata(var_id = 1686,ag = "corede",period = c(2010:2015), add_names = T)
my_data
my_data |> View()
document()
my_data <- getdata(var_id = 1686,ag = "corede",period = c(2010:2015), add_names = T)
my_data
#Development version of the package
library(devtools)
devtools::install_github("fernandoilcruz/deedR")
#Load the package
library(deedR)
data_muni <-
deedR::getdata(var_id = ids, ag = "municipio", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_muni <-
deedR::getdata(var_id = ids, ag = "municipio", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
deedR::geoagregcomp(ag = "corede", geo_id = 7)
vars_corede_ex_2013 <-
deedR::vars(contains = "Idese") |>
dplyr::filter(stringr::str_detect(string = var_name, pattern = "2013", negate = TRUE))
vars_corede_ex_2013
ids <-
vars_corede_ex_2013 |>
dplyr::select(var_id) |>
dplyr::pull()
deedR::vardetails(var_id = ids)
data_muni <-
deedR::getdata(var_id = ids, ag = "municipio", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_corede <- deedR::getdata(var_id = ids, ag = "corede", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_meso <- deedR::getdata(var_id = ids, ag = "meso", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_micro <- deedR::getdata(var_id = ids, ag = "micro", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_estado <-
deedR::getdata(var_id = ids, ag = "estado", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
ft_table <-
deedR::geoagregall2() |>
dplyr::select(-period)
ft_table
my_data <-
ft_table |>
dplyr::left_join(
data_muni,
by = c("geo_id_municipio" = "geo_id",
"geo_name_municipio" = "geo_name")
) |>
dplyr::rename(value_municipio = value) |>
dplyr::left_join(
data_micro,
by = c("geo_id_micro" = "geo_id",
"geo_name_micro" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"unit" = "unit",
"note" = "note")
) |>
dplyr::rename(value_micro = value) |>
dplyr::left_join(
data_meso,
by = c("geo_id_meso" = "geo_id",
"geo_name_meso" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"unit" = "unit",
"note" = "note")
) |>
dplyr::rename(value_meso = value) |>
dplyr::left_join(
data_corede,
by = c("geo_id_corede" = "geo_id",
"geo_name_corede" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"unit" = "unit",
"note" = "note")
) |>
dplyr::rename(value_corede = value) |>
dplyr::left_join(
data_estado,
by = c("geo_id_estado" = "geo_id",
"geo_name_estado" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"unit" = "unit",
"note" = "note")
) |>
dplyr::rename(value_estado = value) |>
dplyr::filter(geo_name_municipio == "Gramado")
ft_table
data_micro
document()
build_vignettes()
.Last.error
package_version("devtools")
package_version(devtools)
package_version("devtools")
session_info()
library(installr)
update.packages()
session_info()
install.packages("desc ")
version
package_version("devtools")
build_vignettes()
library(devtools)
load_all()
check()
#Development version of the package
library(devtools)
devtools::install_github("fernandoilcruz/deedR")
#Load the package
library(deedR)
vars_corede_ex_2013 <-
deedR::vars(contains = "Idese") |>
dplyr::filter(stringr::str_detect(string = var_name, pattern = "2013", negate = TRUE))
ids <-
vars_corede_ex_2013 |>
dplyr::select(var_id) |>
dplyr::pull()
data_muni <-
deedR::getdata(var_id = ids, ag = "municipio", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_corede <- deedR::getdata(var_id = ids, ag = "corede", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_meso <- deedR::getdata(var_id = ids, ag = "meso", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_micro <- deedR::getdata(var_id = ids, ag = "micro", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_estado <-
deedR::getdata(var_id = ids, ag = "estado", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
ft_table <-
deedR::geoagregall2() |>
dplyr::select(-period)
my_data <-
ft_table |>
dplyr::left_join(
data_muni,
by = c("geo_id_municipio" = "geo_id",
"geo_name_municipio" = "geo_name")
) |>
dplyr::rename(value_municipio = value) |>
dplyr::left_join(
data_micro,
by = c("geo_id_micro" = "geo_id",
"geo_name_micro" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_micro = value) |>
dplyr::left_join(
data_meso,
by = c("geo_id_meso" = "geo_id",
"geo_name_meso" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_meso = value) |>
dplyr::left_join(
data_corede,
by = c("geo_id_corede" = "geo_id",
"geo_name_corede" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_corede = value) |>
dplyr::left_join(
data_estado,
by = c("geo_id_estado" = "geo_id",
"geo_name_estado" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_estado = value) |>
dplyr::filter(geo_name_municipio == "Gramado")
my_data
file.edit(".gitignore")
library(devtools)
load_all()
document()
help(getdata)
library(devtools)
load_all()
help(getdata)
my_data <- getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_names = TRUE)
my_data
document()
check()
build_vignettes()
check()
#Development version of the package
library(devtools)
devtools::install_github("fernandoilcruz/deedR")
#Load the package
library(deedR)
vars_corede_ex_2013 <-
deedR::vars(contains = "Idese") |>
dplyr::filter(stringr::str_detect(string = var_name, pattern = "2013", negate = TRUE))
vars_corede_ex_2013
ids <-
vars_corede_ex_2013 |>
dplyr::select(var_id) |>
dplyr::pull()
deedR::vardetails(var_id = ids)
data_muni <-
deedR::getdata(var_id = ids, ag = "municipio", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_corede <- deedR::getdata(var_id = ids, ag = "corede", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_meso <- deedR::getdata(var_id = ids, ag = "meso", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_micro <- deedR::getdata(var_id = ids, ag = "micro", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_estado <-
deedR::getdata(var_id = ids, ag = "estado", period = "all", add_names = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
ft_table <-
deedR::geoagregall2() |>
dplyr::select(-period)
my_data <-
ft_table |>
dplyr::left_join(
data_muni,
by = c("geo_id_municipio" = "geo_id",
"geo_name_municipio" = "geo_name")
) |>
dplyr::rename(value_municipio = value) |>
dplyr::left_join(
data_micro,
by = c("geo_id_micro" = "geo_id",
"geo_name_micro" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_micro = value) |>
dplyr::left_join(
data_meso,
by = c("geo_id_meso" = "geo_id",
"geo_name_meso" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_meso = value) |>
dplyr::left_join(
data_corede,
by = c("geo_id_corede" = "geo_id",
"geo_name_corede" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_corede = value) |>
dplyr::left_join(
data_estado,
by = c("geo_id_estado" = "geo_id",
"geo_name_estado" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_estado = value) |>
dplyr::filter(geo_name_municipio == "Gramado")
library(ggplot2)
#Transform the data to better fit our ggplot
idese <-
my_data |>
dplyr::mutate(year = paste0("01-01-",year) |> lubridate::dmy()) |>
tidyr::gather(
key = agregation,
value = value,
value_municipio,value_micro,value_meso,value_corede,value_estado
) |>
dplyr::mutate(agregation = stringr::str_remove_all(agregation,"value_"))
#Build the graphs
idese_plot <-
idese |>
ggplot2::ggplot(
ggplot2::aes(x = year,
y = value,
colour = agregation)
) +
ggplot2::geom_line() +
ggplot2::facet_wrap(~var_name, scales = "free_y", labeller = ggplot2::label_wrap_gen(width=20)) +
ggplot2::theme(strip.text = ggplot2::element_text(size=8)) +
ggplot2::ggtitle(label = "Gramado",
subtitle = "Idese and components")
#Plot it!
ggplot2::print(idese_plot)
print(idese_plot)
build_vignettes()
check()
document()
library(devtools)
load_all()
build_vignettes()
